#!/bin/bash
#
# For Ubuntu 15.0: 
#   get Ansible >= 2.0 (not bundled with Ubuntu 15.10)
#   see http://docs.ansible.com/ansible/intro_installation.html
#   Ansible's ppa is no longer needed with Ubuntu 16.04.
# sudo apt-get install -y software-properties-common
# sudo apt-add-repository -y ppa:ansible/ansible 

[ -f /etc/sudoers.d/$USER ] || ( (echo "$USER ALL=(ALL) NOPASSWD: ALL" | sudo tee /etc/sudoers.d/$USER) && visudo -cf /etc/sudoers.d/$USER )

sudo apt-get update
sudo apt-get install -y ansible git ruby

[ -f ~/.ssh/id_rsa ] ||  ssh-keygen -b 2048 -f ~/.ssh/id_rsa -t rsa -q -N ""
[ -f ~/.ssh/authorized_keys ] || install -m 0600 ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys
grep -q localhost  ~/.ssh/known_hosts || (ssh-keyscan -t rsa,dsa localhost  >> ~/.ssh/known_hosts)
grep -q 127.0.0.1  ~/.ssh/known_hosts || (ssh-keyscan -t rsa,dsa 127.0.0.1  >> ~/.ssh/known_hosts)
grep -q github.com ~/.ssh/known_hosts || (ssh-keyscan -t rsa,dsa github.com >> ~/.ssh/known_hosts)


cd

# some users may prefer  git@github.com:forensiclogic/mapserver_osm_gis_analytics.git
[ -d mapserver_osm_gis_analytics ] || git clone https://github.com/forensiclogic/mapserver_osm_gis_analytics.git

cd ~/mapserver_osm_gis_analytics

git pull

